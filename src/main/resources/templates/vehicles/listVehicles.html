<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://thymeleaf.org">
<head th:replace="fragments/head"/>
<body>

<!-- Barra de Navegación superior -->
<nav th:replace="fragments/nav"/>
<div class="container">

    <h2>Vehículos</h2>

    <p>Los vehículos que actualmente figuran en el sistema son los siguientes:</p>

    <div class="table-responsive">

        <!-- Botón para actualizar la lista -->
        <button type="button" id="updateButton" class="btn btn-primary">Actualizar</button>

        <script>
            $("#updateButton").click(function() {
                $("#vehiclesTable").load('/vehicle/list/update');
            });
        </script>

        <!-- Formulario para eliminar vehículos seleccionados -->
        <form id="deleteForm" method="post" action="/vehicle/delete" onsubmit="return validateDeleteForm();">
            <button type="submit" class="btn btn-danger">
                Eliminar seleccionados
            </button>

<<<<<<< HEAD
            <table class="table table-hover" id="vehiclesTable">
                <thead>
                <tr>
                    <th scope="col">
                        <input type="checkbox" id="selectAll">
                    </th>
                    <th scope="col">Matrícula</th>
                    <th scope="col">Número de bastidor</th>
                    <th scope="col">Marca</th>
                    <th scope="col">Modelo</th>
                    <th scope="col">Combustible</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="vehicle : ${vehicles}">
                    <td>
                        <input type="checkbox" name="selectedVehicles" th:value="${vehicle.plate}">
                    </td>
                    <td th:text="${vehicle.plate}"></td>
                    <td th:text="${vehicle.chassisNumber}"></td>
                    <td th:text="${vehicle.brandName}"></td>
                    <td th:text="${vehicle.model}"></td>
                    <td th:text="${vehicle.fuelType}"></td>
                </tr>
                </tbody>
            </table>
        </form>

    </div>

    <footer th:replace="fragments/pagination"/>

</div>
<footer th:replace="fragments/footer"/>

<script>
    // Función para validar que al menos un checkbox esté seleccionado antes de enviar
    function validateDeleteForm() {
        let checkboxes = document.querySelectorAll("input[name='selectedVehicles']:checked");
        if (checkboxes.length === 0) {
            alert("Debes seleccionar al menos un vehículo para eliminar.");
            return false; // Evita el envío del formulario
        }
        return confirm("¿Estás seguro de eliminar los vehículos seleccionados?");
    }

    // Funcionalidad de "Seleccionar todos"
    document.getElementById("selectAll").addEventListener("change", function() {
        let checkboxes = document.querySelectorAll("input[name='selectedVehicles']");
        checkboxes.forEach(checkbox => checkbox.checked = this.checked);
    });
</script>

</body>
</html>
